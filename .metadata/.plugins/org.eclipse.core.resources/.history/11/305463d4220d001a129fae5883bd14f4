package com.udemy.JSOUP_TEST;


import com.fasterxml.jackson.databind.ObjectMapper;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import java.io.File;
import java.net.URLEncoder;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import javax.naming.directory.SearchResult;

public class HLTV_ORG {

	private static final String USER_AGENT = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36";
	
	private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();
	
	public static void main(String[] args) throws Exception {
		
		final Document page = Jsoup.connect("https://www.hltv.org/results").userAgent(USER_AGENT).get();
		
		final List<SearchResult> resultList = new ArrayList<SearchResult>();
		
		for (Element searchResult : page.select("body > div.bgPadding > div > div.colCon > div.contentCol > div > div.results-holder > div.results-all > div:nth-child(1)")) {
			final String title = searchResult.text();
			final String url = searchResult.attr("href");
			
			resultList.add(new com.udemy.JSOUP_TEST.SearchResult(title, url));
		}
		
		OBJECT_MAPPER.writerWithDefaultPrettyPrinter().writeValue(new File("results.json"), resultList);
	}
}
